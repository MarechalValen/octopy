Copied from [Tinman](https://github.com/gmr/Tinman/tree/master/tinman/auth)

I had to make some modifications, so I copied it into here. Sorry.
